Реализация модели статической задачи линейной теории упругости методом конечных элементов в стеке с++ cuda c.

Задание по компьютерному практикуму для студентов 6 курса кафедры механики композитов:
- реализовать недостающие процедуры/методы для расчёта статической задачи линейной теории упругости с использованием метода конечных элементов;
- учесть случай плоского напряжения (для блочной матрицы жёсткости);
- после отладки и реализации программы необходимо выполнить расчёт модели в соответствии с заданием(по списку ниже);
- результатом выполненной работы является демонстрация рабочего кода проекта и вывод вектора перемещений по всем узлам модели, при условии что вектор перемещений совпадёт с эталонным расчётом;
- за основу взять курс видео лекций по МКЭ https://youtu.be/_vsjFA28IL8

Список заданий:
1. Глеб Коростелев
t = 1cm
E = 30.6 MN/cm2
v = 0.3
node cm
 0		0
 2.4	0
-1.2	1.9
 1.2	1.9
 3.6	1.9
 0		3.7
 2.4	3.7 
 
elem
 0	 3	 2
 0	 1	 3
 1	 4	 3
 3	 4	 6
 3	 6	 5
 3	 5	 2

bound index x.cm y.cm
 0   0   0
 1   0   0 
 
load index x.MN y.MN
 5   0  -3e-3
 6   0  -3e-3
 
2. Владислав Нередов
t = 1cm
E = 10.6 MN/cm2
v = 0.3
node cm
 6.8	0.0
 9.2	0.0
 5.6	2.2
 8.0	2.2
10.4	2.2
12.8	2.2
 9.2	4.4
11.6	4.4
 
elem
0	3	2
0	1	3
1	4	3
3	4	6
4	7	6
4	5	7

bound index x.cm y.cm
 0   0   0
 1   0   0 
 
load index x.MN y.MN
 6   0  -3e-3
 7   0  -3e-3
 

Проект содержит исходную модель узлов конечных элементов node, списка элементов elem, вектора узловых сил load, вектора кинематических граничных условий bound, толщину и материальные константы.

логи для написания, отладки и сравнения результатов работы программы представлены ниже:

matrix 10x10
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000
0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000      0.0000

elem 0
det 3.400
a               b               c
-3.400          -1.700          -1.000
6.800           1.700           -1.000
0.000           0.000           2.000

PQ[00] pq[00]
matrix 2x2
10.7860     3.6786
3.6786      6.6963


PQ[01] pq[01]
matrix 2x2
-8.4557     -0.2830
0.2830      -0.0383


PQ[03] pq[02]
matrix 2x2
-2.3303     -3.3956
-3.9615     -6.6580


PQ[10] pq[10]
matrix 2x2
-8.4557     0.2830
-0.2830     -0.0383


PQ[11] pq[11]
matrix 2x2
10.7860     -3.6786
-3.6786     6.6963


PQ[13] pq[12]
matrix 2x2
-2.3303     3.3956
3.9615      -6.6580


PQ[30] pq[20]
matrix 2x2
-2.3303     -3.9615
-3.3956     -6.6580


PQ[31] pq[21]
matrix 2x2
-2.3303     3.9615
3.3956      -6.6580


PQ[33] pq[22]
matrix 2x2
4.6606      0.0000
0.0000      13.3161



elem 1
det 3.400
a               b               c
3.400           0.000           -2.000
3.400           1.700           1.000
-3.400          -1.700          1.000

PQ[11] pq[00]
matrix 2x2
4.6606      -0.0000
-0.0000     13.3161


PQ[14] pq[01]
matrix 2x2
-2.3303     -3.9615
-3.3956     -6.6580


PQ[13] pq[02]
matrix 2x2
-2.3303     3.9615
3.3956      -6.6580


PQ[41] pq[10]
matrix 2x2
-2.3303     -3.3956
-3.9615     -6.6580


PQ[44] pq[11]
matrix 2x2
10.7860     3.6786
3.6786      6.6963


PQ[43] pq[12]
matrix 2x2
-8.4557     -0.2830
0.2830      -0.0383


PQ[31] pq[20]
matrix 2x2
-2.3303     3.3956
3.9615      -6.6580


PQ[34] pq[21]
matrix 2x2
-8.4557     0.2830
-0.2830     -0.0383


PQ[33] pq[22]
matrix 2x2
10.7860     -3.6786
-3.6786     6.6963



elem 2
det 3.400
a               b               c
3.400           0.000           -2.000
6.800           1.700           1.000
-6.800          -1.700          1.000

PQ[00] pq[00]
matrix 2x2
4.6606      -0.0000
-0.0000     13.3161


PQ[03] pq[01]
matrix 2x2
-2.3303     -3.9615
-3.3956     -6.6580


PQ[02] pq[02]
matrix 2x2
-2.3303     3.9615
3.3956      -6.6580


PQ[30] pq[10]
matrix 2x2
-2.3303     -3.3956
-3.9615     -6.6580


PQ[33] pq[11]
matrix 2x2
10.7860     3.6786
3.6786      6.6963


PQ[32] pq[12]
matrix 2x2
-8.4557     -0.2830
0.2830      -0.0383


PQ[20] pq[20]
matrix 2x2
-2.3303     3.3956
3.9615      -6.6580


PQ[23] pq[21]
matrix 2x2
-8.4557     0.2830
-0.2830     -0.0383


PQ[22] pq[22]
matrix 2x2
10.7860     -3.6786
-3.6786     6.6963

Sum stiffness is -3.552713679e-15
Sum stiffness ok

matrix 10x10
15.4467     3.6786      -8.4557     -0.2830     -2.3303     3.9615      -4.6606     -7.3571     0           0           |0.0000
3.6786      20.0124     0.2830      -0.0383     3.3956      -6.6580     -7.3571     -13.3161    0           0           |0.0000
-8.4557     0.2830      15.4467     -3.6786     0           0           -4.6606     7.3571      -2.3303     -3.9615     |0.0000
-0.2830     -0.0383     -3.6786     20.0124     0           0           7.3571      -13.3161    -3.3956     -6.6580     |0.0000
-2.3303     3.3956      0           0           10.7860     -3.6786     -8.4557     0.2830      0           0           |0.0000
3.9615      -6.6580     0           0           -3.6786     6.6963      -0.2830     -0.0383     0           0           |-0.0030
-4.6606     -7.3571     -4.6606     7.3571      -8.4557     -0.2830     26.2327     -0.0000     -8.4557     0.2830      |0.0000
-7.3571     -13.3161    7.3571      -13.3161    0.2830      -0.0383     -0.0000     26.7088     -0.2830     -0.0383     |-0.0030
0           0           -2.3303     -3.3956     0           0           -8.4557     -0.2830     10.7860     3.6786      |0.0000
0           0           -3.9615     -6.6580     0           0           0.2830      -0.0383     3.6786      6.6963      |0.0000


Kinematic boundary condition is applied

matrix 10x10
15.4467     0           0           0           0           0           0           0           0           0           |0.0000
0           20.0124     0           0           0           0           0           0           0           0           |0.0000
0           0           15.4467     0           0           0           0           0           0           0           |0.0000
0           0           0           20.0124     0           0           0           0           0           0           |0.0000
0           0           0           0           10.7860     -3.6786     -8.4557     0.2830      0           0           |0.0000
0           0           0           0           -3.6786     6.6963      -0.2830     -0.0383     0           0           |-0.0030
0           0           0           0           -8.4557     -0.2830     26.2327     -0.0000     -8.4557     0.2830      |0.0000
0           0           0           0           0.2830      -0.0383     -0.0000     26.7088     -0.2830     -0.0383     |-0.0030
0           0           0           0           0           0           -8.4557     -0.2830     10.7860     3.6786      |0.0000
0           0           0           0           0           0           0.2830      -0.0383     3.6786      6.6963      |0.0000

matrix 5x5
55.0000     -46.0000    4.0000      0           0           |500.0000
-46.0000    140.0000    -46.0000    0           0           |2000.0000
4.0000      -46.0000    110.0000    -46.0000    4.0000      |1000.0000
0           0           -46.0000    142.0000    -46.0000    |2000.0000
0           0           4.0000      -46.0000    65.0000     |900.0000


Kinematic boundary condition is applied

matrix 5x5
55.0000     0           0           0           0           |8250.0000
0           140.0000    -46.0000    0           0           |8900.0000
0           -46.0000    110.0000    -46.0000    0           |240.0000
0           0           -46.0000    142.0000    0           |3840.0000
0           0           0           0           65.0000     |2600.0000


Kinematic test ok

nz=9
val[9]
I[5]
J[9]
val       I         J
1.000     0         0
4.000     2         1
2.000     4         1
3.000     7         2
5.000     9         0
7.000               3
8.000               4
9.000               2
6.000               4



nz=32
val[32]
I[11]
J[32]
val       I         J
15.447    0         0
20.012    1         1
15.447    2         2
20.012    3         3
10.786    4         4
-3.679    8         5
-8.456    12        6
0.283     18        7
-3.679    24        4
6.696     28        5
-0.283    32        6
-0.038              7
-8.456              4
-0.283              5
26.233              6
-0.000              7
-8.456              8
0.283               9
0.283               4
-0.038              5
-0.000              6
26.709              7
-0.283              8
-0.038              9
-8.456              6
-0.283              7
10.786              8
3.679               9
0.283               6
-0.038              7
3.679               8
6.696               9


> GPU device has 5 Multi-Processors, SM 5.0 compute capabilities

iteration =   1, residual = 2.620849e-03
iteration =   2, residual = 1.363684e-03
iteration =   3, residual = 8.892826e-04
iteration =   4, residual = 8.179503e-04
iteration =   5, residual = 4.207631e-04
iteration =   6, residual = 1.818915e-18
Test Summary:  Error amount = 0.000000


i      x0        x1        u0             u1
0      -4.000    0.000     0.000e+00      0.000e+00
1      -2.000    0.000     0.000e+00      0.000e+00
2      -5.000    1.700     -3.693e-04     -6.595e-04
3      -3.000    1.700     -1.879e-04     -1.112e-04
4      -1.000    1.700     -1.880e-04     1.106e-04
